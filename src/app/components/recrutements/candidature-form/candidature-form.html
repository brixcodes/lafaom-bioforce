<div class="candidature-form">
  <div class="form-container">
    <h2 class="form-title">Formulaire de Candidature</h2>

    <!-- Indicateur de progression -->
    <div class="upload-progress" *ngIf="uploadingCount > 0 || uploadProgress > 0">
      <div class="progress-info">
        <span *ngIf="uploadingCount > 0">Upload en cours... ({{uploadingCount}} fichier(s))</span>
        <span *ngIf="uploadingCount === 0 && uploadProgress > 0">Progression: {{uploadProgress}}%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="uploadProgress"></div>
      </div>
    </div>

    <!-- Messages d'erreur -->
    <div class="error-alert" *ngIf="errors.length > 0">
      <ul>
        <li *ngFor="let error of errors">{{error}}</li>
      </ul>
    </div>

    <form (ngSubmit)="submitApplication()">
      <!-- Informations personnelles -->
      <div class="form-section">
        <h4>Informations personnelles</h4>
        <p class="section-description">Veuillez remplir vos informations personnelles</p>
        
        <div class="form-row">
          <div class="form-group">
            <label for="civility">Civilit√© *</label>
            <select id="civility" [(ngModel)]="form.civility" name="civility" required
                    (change)="logChange('Civilit√©', $event)">
              <option value="">S√©lectionner</option>
              <option *ngFor="let option of civilityOptions" [value]="option.value">
                {{option.label}}
              </option>
            </select>
          </div>
          <div class="form-group">
            <label for="date_of_birth">Date de naissance</label>
            <input type="date" id="date_of_birth" [(ngModel)]="form.date_of_birth" name="date_of_birth"
                   (change)="logChange('Date de naissance', $event)">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="first_name">Pr√©nom *</label>
            <input type="text" id="first_name" [(ngModel)]="form.first_name" name="first_name" required
                   (change)="logChange('Pr√©nom', $event)">
          </div>
          <div class="form-group">
            <label for="last_name">Nom *</label>
            <input type="text" id="last_name" [(ngModel)]="form.last_name" name="last_name" required
                   (change)="logChange('Nom', $event)">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="email">Email *</label>
            <input type="email" id="email" [(ngModel)]="form.email" name="email" required
                   (change)="logChange('Email', $event)">
          </div>
          <div class="form-group">
            <label for="phone_number">T√©l√©phone *</label>
            <input type="tel" id="phone_number" [(ngModel)]="form.phone_number" name="phone_number" required
                   (change)="logChange('T√©l√©phone', $event)">
          </div>
        </div>
      </div>

      <!-- Adresse -->
      <div class="form-section">
        <h4>Adresse</h4>
        <p class="section-description">Votre adresse de r√©sidence</p>
        
        <div class="form-row">
          <div class="form-group">
            <label for="city">Ville *</label>
            <input type="text" id="city" [(ngModel)]="form.city" name="city" required>
          </div>
          <div class="form-group">
            <label for="country_code">Pays</label>
            <select id="country_code" [(ngModel)]="form.country_code" name="country_code">
              <option value="SN">S√©n√©gal</option>
              <option value="ML">Mali</option>
              <option value="BF">Burkina Faso</option>
              <option value="CI">C√¥te d'Ivoire</option>
              <option value="GN">Guin√©e</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="address">Adresse compl√®te *</label>
          <input type="text" id="address" [(ngModel)]="form.address" name="address" required>
        </div>
      </div>

      <!-- Documents requis -->
      <div class="form-section">
        <h4>Documents requis</h4>
        <p class="section-description">Veuillez uploader les documents suivants (PDF, DOC, DOCX)</p>
        
        <div class="documents-grid">
          <!-- CV -->
          <div class="document-upload">
            <div class="document-header">
              <h5>CV *</h5>
              <span class="document-status" [ngClass]="getDocumentStatus('CV')">
                <span *ngIf="getDocumentStatus('CV') === 'pending'">En attente</span>
                <span *ngIf="getDocumentStatus('CV') === 'uploading'">Upload en cours...</span>
                <span *ngIf="getDocumentStatus('CV') === 'completed'">‚úì Termin√©</span>
                <span *ngIf="getDocumentStatus('CV') === 'error'">‚úó Erreur</span>
              </span>
            </div>
            <div class="file-input-container">
              <input type="file" 
                     class="file-input" 
                     (change)="onFileSelected($event, 'CV')"
                     accept=".pdf,.doc,.docx">
              <label class="file-label">
                <span>üìÑ</span>
                <span>Cliquez pour s√©lectionner votre CV</span>
              </label>
            </div>
            <div class="file-info" *ngIf="getSelectedFile('CV')">
              Fichier s√©lectionn√©: {{getSelectedFile('CV')?.name}}
            </div>
          </div>

          <!-- Lettre de motivation -->
          <div class="document-upload">
            <div class="document-header">
              <h5>Lettre de motivation *</h5>
              <span class="document-status" [ngClass]="getDocumentStatus('COVER_LETTER')">
                <span *ngIf="getDocumentStatus('COVER_LETTER') === 'pending'">En attente</span>
                <span *ngIf="getDocumentStatus('COVER_LETTER') === 'uploading'">Upload en cours...</span>
                <span *ngIf="getDocumentStatus('COVER_LETTER') === 'completed'">‚úì Termin√©</span>
                <span *ngIf="getDocumentStatus('COVER_LETTER') === 'error'">‚úó Erreur</span>
              </span>
            </div>
            <div class="file-input-container">
              <input type="file" 
                     class="file-input" 
                     (change)="onFileSelected($event, 'COVER_LETTER')"
                     accept=".pdf,.doc,.docx">
              <label class="file-label">
                <span>üìù</span>
                <span>Cliquez pour s√©lectionner votre lettre de motivation</span>
              </label>
            </div>
            <div class="file-info" *ngIf="getSelectedFile('COVER_LETTER')">
              Fichier s√©lectionn√©: {{getSelectedFile('COVER_LETTER')?.name}}
            </div>
          </div>

          <!-- Dipl√¥me -->
          <div class="document-upload">
            <div class="document-header">
              <h5>Dipl√¥me *</h5>
              <span class="document-status" [ngClass]="getDocumentStatus('DIPLOMA')">
                <span *ngIf="getDocumentStatus('DIPLOMA') === 'pending'">En attente</span>
                <span *ngIf="getDocumentStatus('DIPLOMA') === 'uploading'">Upload en cours...</span>
                <span *ngIf="getDocumentStatus('DIPLOMA') === 'completed'">‚úì Termin√©</span>
                <span *ngIf="getDocumentStatus('DIPLOMA') === 'error'">‚úó Erreur</span>
              </span>
            </div>
            <div class="file-input-container">
              <input type="file" 
                     class="file-input" 
                     (change)="onFileSelected($event, 'DIPLOMA')"
                     accept=".pdf,.doc,.docx">
              <label class="file-label">
                <span>üéì</span>
                <span>Cliquez pour s√©lectionner votre dipl√¥me</span>
              </label>
            </div>
            <div class="file-info" *ngIf="getSelectedFile('DIPLOMA')">
              Fichier s√©lectionn√©: {{getSelectedFile('DIPLOMA')?.name}}
            </div>
          </div>
        </div>
      </div>

      <!-- Boutons d'action -->
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="form = {
          first_name: '',
          last_name: '',
          email: '',
          phone_number: '',
          civility: '',
          city: '',
          address: '',
          date_of_birth: '',
          country_code: 'SN'
        }; attachments = []; errors = [];">
          R√©initialiser
        </button>
        <button type="submit" 
                class="btn btn-primary" 
                [disabled]="!isFormValid() || isSubmitting"
                [ngClass]="{'loading': isSubmitting}">
          <span *ngIf="isSubmitting">Soumission en cours...</span>
          <span *ngIf="!isSubmitting">Soumettre ma candidature</span>
        </button>
      </div>
    </form>
  </div>
</div>
