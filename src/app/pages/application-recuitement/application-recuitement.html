<div class="content">
    <div class="container-1440">
        <div class="page-header">
            <div class="has-background container-full"
                style="background-image: url('https://theangarabucket.s3.eu-north-1.amazonaws.com/public/job-applications/20251012_064544_actualite_s3.jpg')">
                <img src="/https://theangarabucket.s3.eu-north-1.amazonaws.com/public/job-applications/20251012_064544_actualite_s3.jpg"
                    alt="">
            </div>
            <div class="page-header-inner">
                <div class="page-title" *ngIf="jobOffer && !error">
                    <h1 style="text-transform: uppercase;">
                        Offre : {{jobOffer.title}}
                    </h1>
                </div>
                <div class="page-sub-title">
                    <div>
                        <span class="has-border-l-t d-block"></span>
                    </div>
                    <div>
                        <p>
                            Consultez tous les détails de cette offre d'emploi et postulez directement.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="container-1440">
        <div class="alert alert-danger text-center">
            <h4>Erreur</h4>
            <p>{{ error }}</p>
            <div class="mt-3">
                <button (click)="loadJobOffer()" class="btn btn-primary me-2">Réessayer</button>
                <button (click)="goBack()" class="btn btn-secondary">Retour à la liste</button>
            </div>
        </div>
    </div>

    <!-- Job Offer Details -->
    <div *ngIf="jobOffer && !error" class="container-1440">
        <div class="row">
            <!-- Left Column - Job Details -->
            <div class="col-lg-8 container">
                <div class="container-1440">
                    <div class="section-textriche">
                        <h2 class="title-h2">Missions Principales</h2>
                        <br>
                        <div [innerHTML]="jobOffer.main_mission"></div>
                    </div>
                    <div class="section-textriche">
                        <h2 class="title-h2">Responsabilités</h2>
                        <br>
                        <div [innerHTML]="jobOffer.responsibilities"></div>
                    </div>
                    <div class="section-textriche">
                        <h2 class="title-h2">Compétences requises</h2>
                        <br>
                        <div [innerHTML]="jobOffer.competencies"></div>
                    </div>

                    <div class="section-textriche">
                        <h2 class="title-h2">Profil recherché</h2>
                        <br>
                        <div [innerHTML]="jobOffer.profile"></div>
                    </div>
                    <div class="section-textriche">
                        <h2 class="title-h2">Avantages</h2>
                        <br>
                        <div [innerHTML]="jobOffer.benefits"></div>
                    </div>

                    <div class="section-textriche">
                        <h2 class="title-h2">Conditions</h2>
                        <br>
                        <div [innerHTML]="jobOffer.conditions"></div>
                    </div>
                    <div class="section-textriche" *ngIf="jobOffer.attachment && jobOffer.attachment.length > 0">
                        <h2 class="title-h2">Documents à télécharger</h2>
                        <br>
                        <ul>
                            <li *ngFor="let attachment of jobOffer.attachment">
                                {{ translateAttachment(attachment) }}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Right Column - Application Form -->
            <div class="col-lg-4">
                <div class="application-card">
                    <h3>Postuler à cette offre</h3>

                    <!-- Job Summary -->
                    <div class="job-summary">
                        <h4>Résumé du poste</h4>
                        <div class="summary-item">
                            <strong>Référence:</strong> {{ jobOffer.reference }}
                        </div>
                        <div class="summary-item">
                            <strong>Localisation:</strong> {{ jobOffer.location }}
                        </div>
                        <div class="summary-item">
                            <strong>Type de contrat:</strong> {{ jobOffer.contract_type }}
                        </div>
                        <div class="summary-item">
                            <strong>Heures par semaine:</strong> {{ jobOffer.weekly_hours }}h
                        </div>
                        <div class="summary-item">
                            <strong>Salaire:</strong> {{ formatSalary(jobOffer.salary, jobOffer.currency) }}
                        </div>
                        <div class="summary-item">
                            <strong>Frais de candidature:</strong> {{ formatSalary(jobOffer.submission_fee,
                            jobOffer.currency) }}
                        </div>
                        <div class="summary-item">
                            <strong>Date limite:</strong> {{ formatDate(jobOffer.submission_deadline) }}
                        </div>
                    </div>

                    <!-- Application Button -->
                    <div class="application-actions">
                        <button (click)="applyToJob()" class="btn btn-primary btn-lg w-100"
                            [disabled]="isApplicationDeadlinePassed()">
                            Postuler
                        </button>

                        <div *ngIf="isApplicationDeadlinePassed()" class="alert alert-warning mt-3">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            La date limite de candidature est dépassée.
                        </div>
                    </div>

                    <!-- Contact Info -->
                    <div class="contact-info">
                        <h4>Besoin d'aide ?</h4>
                        <p>Si vous avez des questions sur cette offre, contactez-nous :</p>
                        <ul>
                            <li>contact@lafaom-mao.org</li>
                            <li>+4942151603476</li>
                            <li>Ziguinchor, Sénégal</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
